(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{3534:(e,t,l)=>{Promise.resolve().then(l.bind(l,4082))},9136:(e,t,l)=>{"use strict";l.d(t,{A:()=>a});let a=(0,l(7401).A)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},4082:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>p});var a=l(5155),s=l(2115),r=l(6046),i=l(7396),n=l(9124),o=l(7401);let c=(0,o.A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),d=(0,o.A)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var u=l(9136),m=l(7307),x=l(1086),h=l(4191);function p(){let e=(0,r.useRouter)(),{user:t,isAdmin:l,ready:o}=(0,m.J)(),[p,f]=(0,s.useState)([]),[b,v]=(0,s.useState)(!0);(0,s.useEffect)(()=>{if(o){if(!t||!l){e.replace("/");return}(0,x.U)().from("quiz_responses").select("id, user_id, q1, q2, q3, q4, q5").then(e=>{let{data:t}=e;f(null!=t?t:[]),v(!1)})}},[o,t,l,e]);let g=function(e){let t=e.length;if(0===t)return null;let l={};return h.i.forEach(e=>{l[e.id]={},e.options.forEach(t=>{l[e.id][t.value]=0})}),e.forEach(e=>{["q1","q2","q3","q4","q5"].forEach(t=>{var a;let s=e[t];s&&l[t]&&(l[t][s]=(null!==(a=l[t][s])&&void 0!==a?a:0)+1)})}),{total:t,byQuestion:l}}(p);return o&&t&&l?(0,a.jsxs)("div",{className:"min-h-screen flex flex-col bg-[#F5F5F7]",children:[(0,a.jsx)("header",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-[#d2d2d7]/50",children:(0,a.jsx)("div",{className:"container mx-auto px-4 h-14 max-w-4xl flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(i.default,{href:"/",className:"p-2 rounded-2xl text-[#86868b] hover:bg-[#F5F5F7] hover:text-[#1d1d1f] transition",children:(0,a.jsx)(c,{className:"w-5 h-5"})}),(0,a.jsx)(d,{className:"w-5 h-5 text-[#007AFF]"}),(0,a.jsx)("span",{className:"font-semibold text-[#1d1d1f]",children:"Admin"})]})})}),(0,a.jsxs)("main",{className:"flex-1 container mx-auto px-4 py-8 max-w-4xl",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,a.jsx)(u.A,{className:"w-6 h-6 text-[#007AFF]"}),(0,a.jsx)("h1",{className:"text-2xl font-semibold text-[#1d1d1f]",children:"Survey DNA"})]}),(0,a.jsx)("p",{className:"text-sm text-[#86868b] mb-8",children:"Aggregated results from the 5-question survey. Use this to see what the group prefers."}),b?(0,a.jsx)("div",{className:"rounded-[24px] bg-white p-12 text-center shadow-[0_4px_24px_rgba(0,0,0,0.06)]",children:(0,a.jsx)("p",{className:"text-[#86868b]",children:"Loading…"})}):g&&0!==g.total?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-[#1d1d1f]",children:[g.total," response",1!==g.total?"s":""," total"]}),h.i.map((e,t)=>{let l=g.byQuestion[e.id];if(!l)return null;let s=Object.entries(l).filter(e=>{let[,t]=e;return t>0}).sort((e,t)=>t[1]-e[1]),r=t=>{var l,a;return null!==(a=null===(l=e.options.find(e=>e.value===t))||void 0===l?void 0:l.label)&&void 0!==a?a:t};return(0,a.jsxs)(n.P.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"rounded-[24px] bg-white p-6 shadow-[0_4px_24px_rgba(0,0,0,0.06)]",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-[#86868b] mb-3",children:e.label}),(0,a.jsx)("ul",{className:"space-y-2",children:s.map(e=>{let[t,l]=e,s=Math.round(l/g.total*100);return(0,a.jsxs)("li",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-2 rounded-full bg-[#007AFF] transition-all duration-500",style:{width:"".concat(s,"%"),minWidth:s>0?"4px":0}}),(0,a.jsx)("span",{className:"text-sm text-[#1d1d1f]",children:r(t)})]}),(0,a.jsxs)("span",{className:"text-sm font-medium text-[#007AFF] w-10 text-right",children:[s,"%"]})]},t)})})]},e.id)})]}):(0,a.jsx)("div",{className:"rounded-[24px] bg-white p-12 text-center shadow-[0_4px_24px_rgba(0,0,0,0.06)]",children:(0,a.jsx)("p",{className:"text-[#86868b]",children:"No survey responses yet."})})]})]}):null}},7307:(e,t,l)=>{"use strict";l.d(t,{J:()=>c,UserProvider:()=>o});var a=l(5155),s=l(2115);let r="movie-voting-user",i="movie-voting-admin",n=(0,s.createContext)(null);function o(e){let{children:t}=e,[l,o]=(0,s.useState)(null),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{o(function(){try{let e=localStorage.getItem(r);if(!e)return null;let t=JSON.parse(e);if((null==t?void 0:t.id)&&(null==t?void 0:t.full_name)&&(null==t?void 0:t.course)&&(null==t?void 0:t.level))return t}catch(e){}return null}()),d("true"===localStorage.getItem(i)),m(!0)},[]);let x=(0,s.useCallback)(e=>{localStorage.setItem(r,JSON.stringify(e)),o(e)},[]),h=(0,s.useCallback)(()=>{localStorage.removeItem(r),localStorage.removeItem(i),o(null),d(!1)},[]),p=(0,s.useCallback)(e=>"3141"===e&&(localStorage.setItem(i,"true"),d(!0),!0),[]),f=(0,s.useCallback)(()=>{localStorage.removeItem(i),d(!1)},[]),b=(0,s.useMemo)(()=>({user:l,isAdmin:c,ready:u,setUser:x,signOut:h,unlockAdmin:p,lockAdmin:f}),[l,c,u,x,h,p,f]);return(0,a.jsx)(n.Provider,{value:b,children:t})}function c(){let e=(0,s.useContext)(n);if(!e)throw Error("useUser must be used within UserProvider");return e}},4191:(e,t,l)=>{"use strict";l.d(t,{i:()=>a,t:()=>s});let a=[{id:"q1",label:"Preferred accent in films",options:[{value:"british",label:"British"},{value:"american",label:"American"},{value:"no_preference",label:"No preference"}]},{id:"q2",label:"Preferred genre",options:[{value:"comedy",label:"Comedy"},{value:"drama",label:"Drama"},{value:"action",label:"Action"},{value:"documentary",label:"Documentary"}]},{id:"q4",label:"Film length",options:[{value:"short",label:"Short (<90 min)"},{value:"medium",label:"Medium (90–120 min)"},{value:"long",label:"Long (>120 min)"}]},{id:"q5",label:"Preferred era",options:[{value:"classic",label:"Classic (pre-1990)"},{value:"2000s",label:"2000s"},{value:"recent",label:"Recent (2015+)"}]}],s=["q1","q2","q4","q5"]},1086:(e,t,l)=>{"use strict";l.d(t,{U:()=>s});var a=l(9194);function s(){return(0,a.createBrowserClient)("https://peyidfqcjhhjafituwqx.supabase.co","sb_publishable_Zi81Iv4yZKrPDr0NrBI_Wg_JJC8Zt4c")}}},e=>{var t=t=>e(e.s=t);e.O(0,[889,194,396,441,517,358],()=>t(3534)),_N_E=e.O()}]);